#cloud-config
hostname: ${hostname}

disable_root: true
ssh_pwauth: true

network:
  version: 2
  ethernets:
    eth0:
      match:
        macaddress: ${mac_addr}
      set-name: eth0
      dhcp4: true

users:
  - name: ${username}
    sudo: ALL=(ALL) NOPASSWD:ALL
    groups: sudo
    shell: /bin/bash
    lock_passwd: false
    ssh_authorized_keys:
      - ${ssh_key}

chpasswd:
  list: |
    ${username}:ubuntu
  expire: false

package_update: true
packages:
  - qemu-guest-agent

runcmd:
  - systemctl enable --now qemu-guest-agent
